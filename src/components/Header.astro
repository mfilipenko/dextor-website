---
interface Props {
  lang?: 'ua' | 'ru';
}

const { lang = 'ua' } = Astro.props;

const translations = {
  ua: {
    nav: [
      { name: "Техніка", href: "/#fleet" },
      { name: "Послуги", href: "/#services" },
      { name: "Ціни", href: "/#pricing" },
      { name: "Контакти", href: "/#call-to-action" },
    ],
    homeLink: "/",
    otherLang: "ru",
    otherLangLabel: "RU"
  },
  ru: {
    nav: [
      { name: "Техника", href: "/ru/#fleet" },
      { name: "Услуги", href: "/ru/#services" },
      { name: "Цены", href: "/ru/#pricing" },
      { name: "Контакты", href: "/ru/#call-to-action" },
    ],
    homeLink: "/ru",
    otherLang: "ua",
    otherLangLabel: "UA"
  }
};

const t = translations[lang];

// Determine the URL for the language switcher
const currentPath = Astro.url.pathname;
let switchUrl = '/';
if (lang === 'ua') {
  // Switch to RU
  if (currentPath === '/') switchUrl = '/ru';
  else if (currentPath === '/privacy') switchUrl = '/ru/privacy';
  else if (currentPath === '/terms') switchUrl = '/ru/terms';
  else switchUrl = '/ru' + currentPath;
} else {
  // Switch to UA
  if (currentPath === '/ru' || currentPath === '/ru/') switchUrl = '/';
  else if (currentPath.startsWith('/ru/')) switchUrl = currentPath.replace('/ru', '') || '/';
  else switchUrl = '/';
}
---

<header id="main-header" class="fixed w-full bg-white shadow-sm z-50 transition-all duration-500 ease-in-out border-b border-gray-200">
  <div class="container mx-auto px-4 py-4 flex justify-between items-center">
    <a href={t.homeLink} class="flex items-center gap-2 text-2xl font-bold text-primary">
      <img src="/images/dextor_logo.svg" alt="Dextor Logo" class="h-8 w-auto" width="32" height="32" />
      Dextor
    </a>
    
    <nav class="hidden md:flex space-x-8">
      {t.nav.map((item) => (
        <a href={item.href} class="text-gray-700 hover:text-primary font-medium transition-colors">
          {item.name}
        </a>
      ))}
    </nav>

    <div class="flex items-center space-x-4">
      <a href={switchUrl} class="flex items-center text-sm font-semibold border border-gray-300 rounded-full overflow-hidden">
        <span class={`px-3 py-1.5 transition-colors ${lang === 'ua' ? 'bg-primary text-white' : 'text-gray-600 hover:bg-gray-100'}`}>UA</span>
        <span class={`px-3 py-1.5 transition-colors ${lang === 'ru' ? 'bg-primary text-white' : 'text-gray-600 hover:bg-gray-100'}`}>RU</span>
      </a>

      <a href="tel:+380000000000" class="flex items-center bg-primary text-white px-5 py-2 rounded-md font-medium hover:bg-orange-600 transition-colors pulse-cta">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
        </svg>
        <span class="hidden sm:inline">(000) 000-00-00</span>
      </a>
    </div>
  </div>
</header>

<script>
  const header = document.getElementById('main-header');
  let lastScroll = 0;

  window.addEventListener('scroll', () => {
    const currentScroll = window.scrollY;

    // Изменяем прозрачность в зависимости от скролла
    if (currentScroll <= 50) {
      header?.classList.remove('bg-white/80', 'backdrop-blur-md', 'border-white/20');
      header?.classList.add('bg-white', 'border-gray-200');
    } else {
      header?.classList.remove('bg-white', 'border-gray-200');
      header?.classList.add('bg-white/80', 'backdrop-blur-md', 'border-white/20');
    }

    if (currentScroll <= 0) {
      header?.classList.remove('-translate-y-full', 'opacity-0');
      return;
    }

    if (currentScroll > lastScroll && !header?.classList.contains('-translate-y-full')) {
      // Scrolling down
      header?.classList.add('-translate-y-full', 'opacity-0');
    } else if (currentScroll < lastScroll && header?.classList.contains('-translate-y-full')) {
      // Scrolling up
      header?.classList.remove('-translate-y-full', 'opacity-0');
    }

    lastScroll = currentScroll;
  });
</script>
